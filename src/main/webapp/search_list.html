<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>查询</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>头</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="js/jquery-3.3.1.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/getParameter.js"></script>
    <!--    共享header-->
    <script type="text/javascript" src="js/include.js"></script>

    <script>
        $(function () {
            var currentPage=getParameter("currentPage");
            var ename=getParameter("ename");
            if(ename){
                ename=window.decodeURIComponent(ename);
            }
            load(currentPage,ename);
        });
        function load(currentPage,ename) {
            $.post("employee/pageQuery",{currentPage:currentPage,ename:ename},function (pb) {

                var lis='';
                lis+='  <li>\n' +
                    '                 <a href="javascript:load('+1+',\''+ename+'\')" aria-label="Previous">\n' +
                    '                     <span aria-hidden="true">&laquo;</span>\n' +
                    '                </a>\n' +
                    '                </li>';
                let beforePage = currentPage-1;
                if (beforePage<=0){
                    beforePage=1;
                };
                lis+='<li ><a href="javascript:load('+beforePage+',\''+ename+'\')">上一页</a></li>';
                /**页码显示**/
                var begin;
                var end;
                if (pb.totalPage<10){
                    begin=1;
                    end=pb.totalPage;
                }else{
                    begin=pb.currentPage-5;
                    end=pb.currentPage+4;
                    if (begin<=0){
                        begin=1;
                        end=begin+9;
                    }
                    if (end>pb.totalPage){
                        end=pb.totalPage;
                        begin=end-9;
                    }
                };
                for (var i = begin; i <=end ; i++) {
                    if (currentPage==i){
                        lis+='<li class="active" ><a href="javascript:load('+i+',\''+ename+'\')">'+i+'</a></li>';

                    } else{
                        lis+='<li class="curPage" ><a href="javascript:load('+i+',\''+ename+'\')">'+i+'</a></li>';
                    }
                };
                var totalPage=pb.totalPage
                let afterPage = currentPage+1;
                if (afterPage>=totalPage){
                    afterPage=totalPage;
                };
                lis+='<li ><a href="javascript:load('+afterPage+',\''+ename+'\')">下一页</a></li>';
                lis+=' <li>\n' +
                    '                    <a href="javascript:load('+totalPage+',\''+ename+'\')" aria-label="Next">\n' +
                    '                        <span aria-hidden="true">&raquo;</span>\n' +
                    '                    </a>\n' +
                    '                </li>';
                lis+=' <span class="page_num_inf" style=" " >\n' +
                    '                    <i></i> 共\n' +
                    '                    <span id="totalPage">'+totalPage+'</span>页<span id="totalCount">'+pb.totalCount+'</span>条\n' +
                    '                </span>'
                $("#pageNum").html(lis);

                var detials_lis="";
                detials_lis+='   <thead>\n' +
                    '            <td>id</td>\n' +
                    '            <td>名字</td>\n' +
                    '            <td>所属部门</td>\n' +
                    '            <td>工作职位</td>\n' +
                    '            <td>性别</td>\n' +
                    '            <td>年龄</td>\n' +
                    '            <td>工作类别</td>\n' +
                    '            <td>电话号码</td>\n' +
                    '            <td>工龄</td>\n' +
                    '            <td><a class="btn btn-info" href="javascript:deleteSelect()">删除选中</a></td>\n' +
                    '            <td><a class="btn btn-info" href="salary_list.html">查看工资</a></td>\n' +
                    '            <td></td>\n' +

                    '        </thead>';
                for (let i = 0; i <pb.list.length ; i++) {
                    let listElement = pb.list[i];
                    detials_lis+=' <tr>\n' +
                        '            <td>'+listElement.eid+'</td>\n' +
                        '            <td>'+listElement.ename+'</td>\n' +
                        '            <td>'+listElement.dname+'</td>\n' +
                        '            <td>'+listElement.jname+'</td>\n' +
                        '            <td>'+listElement.esex+'</td>\n' +
                        '            <td>'+listElement.eage+'</td>\n' +
                        '            <td>'+listElement.etag+'</td>\n' +
                        '            <td>'+listElement.ephone+'</td>\n' +
                        '            <td>'+listElement.eworkyear+'</td>\n' +
                        '            <td><a  class="btn btn-info" href="javascript:deleteOne('+listElement.eid+')">删除</a><input type="checkbox" class="ck" value='+listElement.eid+'></td>\n' +
                        '            <td><a  class="btn btn-info" href="salary_list.html?eid='+listElement.eid+'">查看工资</a></td>\n' +
                        '            <td><a  class="btn btn-info" href="addSalary.html?eid='+listElement.eid+'">添加工资</a></td>\n' +
                        '            <td><a  class="btn btn-info" href="updateinfo.html?eid='+listElement.eid+'">修改信息</a></td>\n' +

                        '        </tr>'

                }
                $("#list").html(detials_lis);
        })
        }
        function deleteSelect() {
            if (window.confirm("确认删除?")){
            var arry =[];
            $(".ck").each(function () {
                if ($(this).prop('checked')){
                    arry.push($(this).val());
                }
            })
             $.post("employee/deleteSelect",{arry :JSON.stringify(arry)},function () {
                alert("删除成功");
             })
            location.href="search_list.html";
            }
            else{};
        }
        function deleteOne(eid) {
            if (window.confirm("确认删除?")){

                $.post("employee/deleteOne",{eid :eid},function () {
                    alert("删除成功");
                })
                location.href="search_list.html";
            } else{}
        }

    </script>
</head>
<body style="   background-size: 100%;">
<div id="header"></div>
<div  style="margin-top: 120px; width: 80%   ; border: 0px solid; margin-left: 10%">
    <div style="margin: 0 auto ;height: 330px ">
    <table class="table table-hover " id="list"  style="">
        <thead>
            <td>id</td>
            <td>名字</td>
            <td>所属部门</td>
            <td>工作职位</td>
            <td>性别</td>
            <td>年龄</td>
            <td>工作类别</td>
            <td>电话号码</td>
            <td>工龄</td>
            <td><a href="javascript:deleteSelect()">删除选中</a></td>
            <td><a href="#">查看工资</a></td>
            <td></td>

        </thead>


        <tr>
            <td>1</td>
            <td>徐念</td>
            <td>研发部</td>
            <td>组长</td>
            <td>女</td>
            <td>25</td>
            <td>正式员工</td>
            <td>12345678911</td>
            <td>4</td>
            <td><a href="#" class="btn btn-primary">删除</a><input type="checkbox" class="ck" value="1"></td>

            <td><a href="#">查看工资</a></td>
            <td><a href="#">修改</a></td>
        </tr>
        <tr>
            <td>1</td>
            <td>徐念</td>
            <td>研发部</td>
            <td>组长</td>
            <td>女</td>
            <td>25</td>
            <td>正式员工</td>
            <td>12345678911</td>
            <td>4</td>
            <td><a href="#">删除</a><input type="checkbox" class="ck" value="2"></td>
            <td><a href="#">查看工资</a></td>
            <td><a href="#">修改</a></td>

        </tr>
        <tr>
            <td>1</td>
            <td>徐念</td>
            <td>研发部</td>
            <td>组长</td>
            <td>女</td>
            <td>25</td>
            <td>正式员工</td>
            <td>12345678911</td>
            <td>4</td>
            <td><a href="#">删除</a><input type="checkbox" class="ck" value="3"></td>

            <td><a href="#">查看工资</a></td>
            <td><a href="#">修改</a></td>
        </tr>
        <tr>
            <td>1</td>
            <td>徐念</td>
            <td>研发部</td>
            <td>组长</td>
            <td>女</td>
            <td>25</td>
            <td>正式员工</td>
            <td>12345678911</td>
            <td>4</td>
            <td><a href="#">删除</a><input type="checkbox" class="ck" value="4"></td>

            <td><a href="#">查看工资</a></td>
            <td><a href="#">修改</a></td>
        </tr>
        <tr>
            <td>1</td>
            <td>徐念</td>
            <td>研发部</td>
            <td>组长</td>
            <td>女</td>
            <td>25</td>
            <td>正式员工</td>
            <td>12345678911</td>
            <td>4</td>
            <td><a href="#">删除</a><input type="checkbox" class="ck" value="5"></td>

            <td><a href="#">查看工资</a></td>
            <td><a href="#">修改</a></td>
        </tr>
        <tr>
            <td>1</td>
            <td>徐念</td>
            <td>研发部</td>
            <td>组长</td>
            <td>女</td>
            <td>25</td>
            <td>正式员工</td>
            <td>12345678911</td>
            <td>4</td>
            <td><a href="#">删除</a><input type="checkbox" class="ck" value="6"></td>

            <td><a href="#">查看工资</a></td>
            <td><a href="#">修改</a></td>
        </tr>
        <tr>
            <td>1</td>
            <td>徐念</td>
            <td>研发部</td>
            <td>组长</td>
            <td>女</td>
            <td>25</td>
            <td>正式员工</td>
            <td>12345678911</td>
            <td>4</td>
            <td><a href="#">删除</a><input type="checkbox" class="ck" value="7"></td>

            <td><a href="#">查看工资</a></td>
            <td><a href="#">修改</a></td>
        </tr>




    </table>

    </div>
    <div style="margin-top:40px" >

        <div style="margin-left: 5% ;">


                <ul class="pagination pagination " id="pageNum" >
                    <li>
                        <a href="#" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <li class="threeword"><a href="#">1</a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">3</a></li>
                    <li><a href="#">4</a></li>
                    <li><a href="#">5</a></li>
                    <li>
                        <a href="#" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>



        </div>

    </div>
</div>
</body>
</html>